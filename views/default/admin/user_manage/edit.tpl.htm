<?php TPL::output('admin/global/header.tpl.htm'); ?>
<?php TPL::output('admin/global/nav_menu.tpl.htm'); ?>

<div class="pull-left right-side">	
	<div class="aw-box">
		<div class="aw-mod-head">
			<h2><?php _e('编辑用户资料'); ?></h2>
		</div>
		<div class="aw-mod-body">
			<dl>
				<dt><h3><?php _e('删除用户'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<label><input name="remove_user" id="remove_user" type="checkbox" value="1" /> <?php _e('确认删除这个用户'); ?></label> <a href="javascript:;" class="btn btn-danger btn-xs" onclick="if (!document.getElementById('remove_user').checked) { alert('<?php _e('请先确认删除操作'); ?>'); } else { ajax_request(G_BASE_URL + '/admin/user_manage/remove_user/', 'uid=<?php echo $this->user['id']; ?>'); }"><?php _e('删除用户'); ?></a>
						</div>
					</div>
				</dd>
			</dl>
			
			<form action="admin/user_manage/user_save_ajax/" id="settings_form" enctype="multipart/form-data" method="post">
			<input name="uid" type="hidden" value="<?php echo $this->user['uid']; ?>" />
			
			<dl>
				<dt><h3><?php _e('用户名'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="user_name" type="text" value="<?php echo $this->user['user_name']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('密码'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-3">
							<input class="form-control" name="password" type="text" value="" />
							<p class="aw-text-color-999"><?php _e('不更改请留空'); ?></p>
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><label><?php _e('现居'); ?>:</label></dt>
				<dd>
					<select name="province" class="select_area"></select> <select name="city" class="select_area"></select>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('职业'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<select name="job_id">
								<option value="">--</option>
								<?php echo H::display_options($this->job_list, $this->user['job_id']); ?>
							</select>
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('邮箱'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="email" type="text" value="<?php echo $this->user['email']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('手机号码'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="mobile" type="text" value="<?php echo $this->user['mobile']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3>QQ:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="qq" type="text" value="<?php echo $this->user['qq']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('常用邮箱'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="common_email" type="text" value="<?php echo $this->user['common_email']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('网站'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="homepage" type="text" value="<?php echo $this->user['homepage']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('一句话介绍'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-7">
							<input class="form-control" name="signature" type="text" value="<?php echo $this->user['signature']; ?>" />
						</div>
					</div>
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('积分'); ?>: </h3></dt>
				
				<dd><?php echo $this->user['integral']; ?></span> &nbsp; <a href="admin/user_manage/integral_log/uid-<?php echo $this->user['uid']; ?>">[ <?php _e('操作积分'); ?> ]</a></dd>
			</dl>
			<dl>
				<dt><h3><?php _e('邮箱激活状态'); ?>:</h3></dt>
				
				<dd>
					<span class="yesno_yes">
						<label><input type="radio" name="valid_email" value="1"<?php if ($this->user['valid_email'] == 1) { ?> checked="checked"<?php } ?> /><?php _e('是'); ?></label>
					</span>
				
					<span class="yesno_no">
						<label><input type="radio" name="valid_email" value="0"<?php if ($this->user['valid_email'] == 0) { ?> checked="checked"<?php } ?> /><?php _e('否'); ?></label>
					</span>
			</dl>
			<dl>
				<dt><h3><?php _e('认证用户'); ?>:</h3></dt>
				
				<dd>
					<label><input type="radio" name="verified" value=""<?php if ($this->user['verified'] == '') { ?> checked="checked"<?php } ?> /><?php _e('无'); ?></label>
					<label><input type="radio" name="verified" value="personal"<?php if ($this->user['verified'] == 'personal') { ?> checked="checked"<?php } ?> /><?php _e('个人认证'); ?></label>
					<label><input type="radio" name="verified" value="enterprise"<?php if ($this->user['verified'] == 'enterprise') { ?> checked="checked"<?php } ?>/><?php _e('机构认证'); ?></label> &nbsp; [ <a href="admin/user_manage/verify_approval_edit/<?php echo $this->user['uid']; ?>"><?php _e('编辑认证审核资料'); ?></a> ]
				</dd>
			</dl>
			<dl>
				<dt><h3><?php _e('头像'); ?>:</h3></dt>
				<dd><p><img src="<?php echo get_avatar_url($this->user['uid'], 'mid'); ?>" alt="" class="img-polaroid" /></p>
				<p><?php _e('更换头像'); ?>: <input name="user_avatar" type="file" /></p>
				<p><input name="delete_avatar" type="checkbox" value="1" /> <?php _e('删除头像'); ?></p>
				</dd>
			</dl>
			
			<?php if ($this->user_info['group_id'] == 1) { ?>
			<dl>
				<dt><h3><?php _e('用户组'); ?>:</h3></dt>
				<dd><select name="group_id">
					<?php foreach($this->system_group as $skey => $val){ ?>
					<option value="<?php echo $val['group_id']; ?>"<?php if ($this->user['group_id'] == $val['group_id']) { ?> selected="selected"<?php } ?>><?php echo $val['group_name']; ?></option>
					<?php } ?>
				</select></dd>
			</dl>
			<?php } ?>
			
			<dl>
				<dt><h3><?php _e('封禁用户'); ?>:</h3></dt>
				
				<dd>
					<span class="yesno_yes">
						<label><input type="radio" name="forbidden" value="1"<?php if ($this->user['forbidden'] == 1) { ?> checked="checked"<?php } ?> /><?php _e('是'); ?></label>
					</span>
				
					<span class="yesno_no">
						<label><input type="radio" name="forbidden" value="0"<?php if ($this->user['forbidden'] == 0) { ?> checked="checked"<?php } ?> /><?php _e('否'); ?></label>
					</span>
			</dl>
			
			<dl>
				<dt><h3><?php _e('注册时间'); ?>:</h3></dt>
				<dd><?php echo date_friendly($this->user['reg_time']); ?></dd>
			</dl>
			
			<?php if ($this->user['reg_ip']) { ?>
			<dl>
				<dt><h3><?php _e('注册 IP'); ?>:</h3></dt>
				<dd><?php echo long2ip($this->user['reg_ip']); ?></dd>
			</dl>
			<?php } ?>
			
			<?php if ($this->user['last_ip']) { ?>
			<dl>
				<dt><h3><?php _e('上次登录 IP'); ?>:</h3></dt>
				<dd><?php echo long2ip($this->user['last_ip']); ?></dd>
			</dl>
			<?php } ?>
			<dl>
				<dt><h3><?php _e('上次登录时间'); ?>:</h3></dt>
				<dd><?php echo date_friendly($this->user['last_login']); ?></dd>
			</dl>
			
			<dl>
				<dt><h3><?php _e('性别'); ?>:</h3></dt>
				
				<dd>
					<label><input type="radio" name="sex" value="1"<?php if ($this->user['sex'] == 1) { ?> checked="checked"<?php } ?> /><?php _e('男'); ?></label>
					<label><input type="radio" name="sex" value="2"<?php if ($this->user['sex'] == 2) { ?> checked="checked"<?php } ?> /><?php _e('女'); ?></label>
					<label><input type="radio" name="sex" value="3"<?php if (!$this->user['sex'] OR $this->user['sex'] == 3) { ?> checked="checked"<?php } ?>/><?php _e('保密'); ?></label>
				</dd>
			</dl>

			<dl>
				<dt><h3><?php _e('可用邀请名额'); ?>:</h3></dt>
				<dd>
					<div class="row">
						<div class="col-sm-3">
							<input class="form-control" name="invitation_available" type="text" value="<?php echo $this->user['invitation_available']; ?>"/>
						</div>
					</div>
				</dd>
			</dl>
			</form>
		</div>
		<div class="aw-mod-footer">
			<a href="javascript:;" class="btn btn-inverse btn-normal" onclick="ajax_post($('#settings_form'));"><?php _e('保存'); ?></a>
		</div>
	</div>
</div>

<script type="text/javascript">
$(document).ready(function () {
	$('.select_area').LocationSelect({
        labels: ["<?php _e('请选择省份或直辖市'); ?>", "<?php _e('请选择城市'); ?>"],
        elements: document.getElementsByTagName("select"),
        detector: function () {
            this.select(["<?php echo $this->user['province']; ?>", "<?php echo $this->user['city']; ?>"]);
        },
		dataUrl: G_BASE_URL + '/account/ajax/areas_json_data/'
    });
});
</script>

<?php TPL::output('admin/global/footer.tpl.htm'); ?>